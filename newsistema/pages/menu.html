<!DOCTYPE html>

<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title data-i18n="menu_title">Menu Principal - ONG Novo Amanhã</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="../css/config-styles.css" rel="stylesheet"/>
<link href="../css/global.css" rel="stylesheet"/>
<link href="../css/navbar.css" rel="stylesheet"/>
<link href="../css/cards.css" rel="stylesheet"/>
<link href="../css/background-pattern.css" rel="stylesheet"/>
<link href="../css/themes.css" rel="stylesheet"/>
<!-- Bootstrap JS Bundle -->
<script src="../libs/bootstrap.bundle.min.js"></script>
<!-- Firebase -->
<script src="../libs/firebase-app-compat.js"></script>
<script src="../libs/firebase-auth-compat.js"></script>
<script src="../libs/firebase-firestore-compat.js"></script>
<!-- Translations -->
<script src="../js/translations.js"></script>
<!-- Settings Manager -->
<script src="../js/settings-manager.js"></script>
<!-- Session Timeout -->
<script src="../js/session-timeout.js"></script>
<script src="../js/auth-guard.js" type="module"></script>
<script src="../js/permissoes.js" type="module"></script>
<script src="../js/preferencias.js" type="module"></script>
<script src="../js/preferencia-aplicacao.js" type="module"></script>
</head>
<body class=""><i class="fa fa-bell" id="notificacoes"></i>
<!-- Removido elementos decorativos de fundo -->
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top shadow" style="background-color: var(--primary-color);">
<div class="container-fluid">
<a class="navbar-brand" href="#" style="display: flex; align-items: center; gap: 10px;">
<i class="bi bi-box-seam"></i>
<span class="h5 mb-0" data-i18n="platform_name">Beta - Plataforma de Gestão</span>
</a>
<div class="dropdown">
<div aria-expanded="false" class="user-profile" data-bs-toggle="dropdown" id="userProfileDropdown">
<div class="avatar" id="userAvatar">UT</div>
<div class="user-info">
<span class="user-name" data-i18n="user_name" id="userName">Usuário</span>
<i class="bi bi-chevron-down dropdown-arrow"></i>
</div>
</div>
<ul aria-labelledby="userProfileDropdown" class="dropdown-menu dropdown-menu-end">
<li>
<div class="dropdown-header">
<div class="avatar-small" id="userAvatarSmall">UT</div>
<div class="header-info">
<span class="header-name" data-i18n="user_full_name" id="userNameFull">Usuário</span>
<span class="header-email" data-i18n="user_email" id="userEmail">usuario@email.com</span>
</div>
</div>
</li>
<li><hr class="dropdown-divider"/></li>
<li>
<a class="dropdown-item" href="pages/perfil.html" title="Visualizar e editar seu perfil">
<i class="bi bi-person-circle"></i>
<div class="item-content">
<span class="item-title" data-i18n="profile">Perfil</span>
<span class="item-description" data-i18n="view_edit_profile">Visualizar e editar suas informações</span>
</div>
</a>
</li>
<li>
<a class="dropdown-item" href="pages/configuracoes.html" title="Ajustar configurações do sistema">
<i class="bi bi-gear"></i>
<div class="item-content">
<span class="item-title" data-i18n="settings">Configurações</span>
<span class="item-description" data-i18n="customize_experience">Personalizar sua experiência</span>
</div>
</a>
</li>
<li><hr class="dropdown-divider"/></li>
<li>
<a class="dropdown-item logout-item" href="#" id="btnLogout" title="Sair do sistema">
<i class="bi bi-box-arrow-right"></i>
<div class="item-content">
<span class="item-title" data-i18n="logout">Sair</span>
<span class="item-description" data-i18n="end_session">Encerrar sessão</span>
</div>
</a>
</li>
</ul>
</div>
</div>
</nav>
<!-- Hero Section -->
<main>
<div class="hero-section">
<div class="hero-overlay"></div>
<div class="hero-content">
<h1>BEM VINDO USUÁRIO!</h1>
<p>Escolha uma das opções para continuar:</p>
</div>
</div>
<!-- Conteúdo Principal -->
<div class="container mt-n4 fade-in">
<!-- Menu de Opções -->
<div class="cards-container">
<!-- Cadastro de Alunos -->
<a class="menu-card" href="alunos.html">
<i class="bi bi-person-plus-fill"></i>
<h4>Cadastro de Alunos</h4>
<p>Gerenciamento de matrículas e informações dos alunos</p>
</a>
<!-- Registro de Presença -->
<a class="menu-card" href="chamada.html">
<i class="bi bi-calendar-check"></i>
<h4>Registro de Presença</h4>
<p>Gerenciamento de turmas e controle de presença</p>
</a>
<!-- Dashboard -->
<a class="menu-card" href="dashboard.html">
<i class="bi bi-graph-up"></i>
<h4>Dashboard</h4>
<p>Visualize estatísticas e relatórios</p>
</a>
<!-- Calendário -->
<a class="menu-card" href="calendario.html">
<i class="bi bi-calendar3"></i>
<h4>Calendário</h4>
<p>Agenda de eventos e atividades</p>
</a>
<!-- Documentos -->
<a class="menu-card" href="documentos.html">
<i class="bi bi-folder2-open"></i>
<h4>Documentos</h4>
<p>Gerenciamento de documentos</p>
</a>
<!-- Doações -->
<a class="menu-card" href="doacoes.html">
<i class="bi bi-heart-fill"></i>
<h4>Doações</h4>
<p>Controle e gestão de doações</p>
</a>
<!-- Galeria -->
<a class="menu-card" href="galeria.html">
<i class="bi bi-images"></i>
<h4>Galeria</h4>
<p>Albuns de fotos e memórias dos eventos</p>
</a>
<!-- Guia do Usuário -->
<a class="menu-card" href="guia.html">
<i class="bi bi-book"></i>
<h4>Guia do Usuário</h4>
<p>Aprenda a usar a plataforma</p>
</a>
</div>
<!-- Modal de Configurações -->
<div aria-hidden="true" aria-labelledby="configModalLabel" class="modal fade" id="configModal" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="configModalLabel"><i class="bi bi-gear"></i> Configurações do Sistema</h5>
<button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
</div>
<div class="modal-body">
<div class="row g-4">
<!-- Aparência & Acessibilidade -->
<div class="col-md-6">
<div class="card h-100">
<div class="card-body">
<h6 class="card-title mb-3"><i class="bi bi-palette"></i> Aparência &amp; Acessibilidade</h6>
<div class="d-grid gap-2">
<button class="btn btn-outline-secondary btn-sm text-start" id="toggleTheme">
<i class="bi bi-circle-half"></i> Tema Claro/Escuro
                    </button>
<button class="btn btn-outline-secondary btn-sm text-start" id="toggleReadingMode">
<i class="bi bi-book"></i> Modo Leitura
                    </button>
<button class="btn btn-outline-secondary btn-sm text-start" id="toggleColorblindMode">
<i class="bi bi-eye"></i> Modo Daltônico
                    </button>
<button class="btn btn-outline-secondary btn-sm text-start" id="toggleSimpleText">
<i class="bi bi-text-left"></i> Texto Simplificado
                    </button>
</div>
</div>
</div>
</div>
<!-- Idioma & Inclusão -->
<div class="col-md-6">
<div class="card h-100">
<div class="card-body">
<h6 class="card-title mb-3"><i class="bi bi-translate"></i> Idioma &amp; Inclusão</h6>
<div class="mb-3">
<label class="form-label">Selecionar Idioma</label>
<select class="form-select" id="languageSelect">
<option selected="" value="pt-BR">Português (BR)</option>
<option value="en">English</option>
</select>
</div>
<div class="d-grid gap-2">
<button class="btn btn-outline-secondary btn-sm text-start" id="togglePronouns">
<i class="bi bi-person-badge"></i> Exibir Pronomes
                    </button>
<button class="btn btn-outline-secondary btn-sm text-start" id="toggleTechVocab">
<i class="bi bi-chat-quote"></i> Vocabulário Técnico
                    </button>
</div>
</div>
</div>
</div>
<!-- Notificações -->
<div class="col-md-6">
<div class="card h-100">
<div class="card-body">
<h6 class="card-title mb-3"><i class="bi bi-bell"></i> Notificações</h6>
<div class="d-grid gap-2">
<button class="btn btn-outline-secondary btn-sm text-start" id="toggleSounds">
<i class="bi bi-volume-up"></i> Sons
                    </button>
<button class="btn btn-outline-secondary btn-sm text-start" id="togglePopups">
<i class="bi bi-bell"></i> Pop-ups Visuais
                    </button>
<button class="btn btn-outline-secondary btn-sm text-start" disabled="">
<i class="bi bi-calendar-heart"></i> Lembrete de Aniversários
                    </button>
</div>
</div>
</div>
</div>
<!-- Mascote Virtual -->
<div class="col-md-6">
<div class="card h-100">
<div class="card-body">
<h6 class="card-title mb-3"><i class="bi bi-emoji-smile"></i> Mascote Virtual</h6>
<div class="form-check form-switch mb-3">
<input class="form-check-input" id="toggleMascot" type="checkbox"/>
<label class="form-check-label" for="toggleMascot">Ativar Mascote</label>
</div>
<div class="mb-3">
<label class="form-label">Nível de Interação</label>
<select class="form-select" id="mascotInteraction">
<option value="quiet">Quieto</option>
<option selected="" value="polite">Educado</option>
<option value="sassy">Atrevido</option>
</select>
</div>
<button class="btn btn-outline-secondary btn-sm" id="customizeMascot">
<i class="bi bi-palette"></i> Personalizar Mascote
                  </button>
</div>
</div>
</div>
<!-- Administração (visível apenas para admins) -->
<div class="col-12" id="adminSection">
<div class="card">
<div class="card-body">
<h6 class="card-title mb-3"><i class="bi bi-shield-lock"></i> Administração</h6>
<a class="btn btn-outline-secondary btn-sm" href="auditoria.html" id="viewLogs">
<i class="bi bi-journal-text"></i> Logs e Auditoria
                  </a>
</div>
</div>
</div>
</div>
</div>
<div class="modal-footer">
<button class="btn btn-outline-secondary" data-bs-dismiss="modal" type="button">Fechar</button>
<button class="btn btn-purple" style="background-color: #6f42c1; color: white;" type="button">Salvar Alterações</button>
</div>
</div>
</div>
</div>
<!-- Scripts -->
<script type="module">

    // Elementos do perfil do usuário
    const userNameElement = document.getElementById('userName');
    const userAvatarElement = document.getElementById('userAvatar');
    const welcomeUserNameElement = document.getElementById('welcomeUserName');
    const userNameFullElement = document.getElementById('userNameFull');
    const userEmailElement = document.getElementById('userEmail');
    const userAvatarSmallElement = document.getElementById('userAvatarSmall');

    // Verificar autenticação
      console.log('Estado de autenticação alterado:', user ? 'autenticado' : 'não autenticado');

      // Configurar botão de logout
      document.getElementById('btnLogout').addEventListener('click', async () => {
        try {
          await signOut(auth);
          window.location.href = '../index.html';
        } catch (error) {
          console.error('Erro ao fazer logout:', error);
        }
      });
      if (!user) {
        // Se não estiver autenticado, redirecionar para login
        console.log('Usuário não autenticado, redirecionando para login...');
        window.location.replace('/index.html');
      }
      console.log('Usuário autenticado:', user.email);

      try {
        // Buscar dados do usuário no Firestore
        const userDoc = await getDoc(doc(db, 'usuarios', user.uid));
        const userData = userDoc.data();

        // Definir nome para exibição
        const displayName = userData?.nome || user.email || 'Usuário';
        const firstName = displayName.split(' ')[0];
        const userEmail = user.email;

        // Atualizar elementos da interface
        if (userNameElement) userNameElement.textContent = firstName;
        if (welcomeUserNameElement) welcomeUserNameElement.textContent = firstName;

        // Atualizar header do dropdown
        const userNameFullElement = document.getElementById('userNameFull');
        const userEmailElement = document.getElementById('userEmail');
        if (userNameFullElement) userNameFullElement.textContent = displayName;
        if (userEmailElement) userEmailElement.textContent = userEmail;

        // Configurar iniciais do avatar
        const initials = userData?.nome
            ? userData.nome.split(' ')
                .map(n => n[0])
                .join('')
                .toUpperCase()
                .slice(0, 2)
            : user.email[0].toUpperCase();

        if (userAvatarElement) userAvatarElement.textContent = initials;
        const userAvatarSmallElement = document.getElementById('userAvatarSmall');
        if (userAvatarSmallElement) userAvatarSmallElement.textContent = initials;
      } catch (error) {
        console.error('Erro ao buscar dados do usuário:', error);
        if (welcomeUserNameElement) welcomeUserNameElement.textContent = 'Usuário';
      }
    });

    // Configurar botão de logout
    const btnLogout = document.getElementById('btnLogout');
    if (btnLogout) {
      btnLogout.addEventListener('click', async (event) => {
        event.preventDefault();
        try {
          await auth.signOut();
          window.location.href = '../index.html';
        } catch (error) {
          console.error('Erro ao fazer logout:', error);
          alert('Erro ao fazer logout.');
        }
      });
    }
  </script>
<script src="../utils/default.js"></script>
<div class="user-menu">
<div class="user-info" onclick="toggleDropdown()" style="cursor:pointer;">
<img alt="Avatar" class="user-avatar" src="assets/avatar-default.png"/>
<span id="user-name">Usuário</span>
<i class="bi bi-caret-down-fill"></i>
</div>
<div class="user-dropdown hidden" id="user-dropdown">
<a href="pages/perfil.html">Perfil</a>
<a href="pages/configuracoes.html">Configurações</a>
<a href="#" onclick="logout()">Sair</a>
</div>
</div>
<script>
function toggleDropdown() {
  document.getElementById("user-dropdown").classList.toggle("hidden");
}

function logout() {
  localStorage.clear();
  window.location.href = "../index.html";
}
</script>
<style>
.user-menu {
  position: relative;
  display: inline-block;
}

.user-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  vertical-align: middle;
}

.user-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.user-dropdown {
  display: none;
  position: absolute;
  top: 100%;
  right: 0;
  background-color: white;
  border: 1px solid #ccc;
  padding: 8px;
  z-index: 1000;
}

.user-dropdown a {
  display: block;
  padding: 6px 10px;
  color: #333;
  text-decoration: none;
}

.user-dropdown a:hover {
  background-color: #f0f0f0;
}

.user-dropdown.hidden {
  display: none;
}

.user-dropdown:not(.hidden) {
  display: block;
}
</style>
</div></main> <!-- Assistente Virtual Beta -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const savedTheme = localStorage.getItem("modo-escuro");
  if (savedTheme === "ativado") {
    document.body.classList.add("modo-escuro");
  }

  const toggle = document.getElementById("toggle-modo-escuro");
  if (toggle) {
    toggle.addEventListener("click", () => {
      document.body.classList.toggle("modo-escuro");
      const ativado = document.body.classList.contains("modo-escuro");
      localStorage.setItem("modo-escuro", ativado ? "ativado" : "desativado");
    });
  }
});
</script>
<!-- Assistente Beta fixa -->
<div id="beta-button" style="position:fixed;bottom:20px;right:20px;z-index:99999;background:#7a00cc;color:#fff;border:none;border-radius:50%;width:60px;height:60px;display:flex;align-items:center;justify-content:center;box-shadow:0 0 10px rgba(0,0,0,0.3);cursor:pointer;font-size:28px;">
🤖
</div>
<div id="beta-drawer" style="position:fixed;top:0;right:-400px;width:350px;max-width:100%;height:100vh;background:white;box-shadow:-2px 0 10px rgba(0,0,0,0.2);transition:right 0.3s ease-in-out;z-index:99998;padding:20px;overflow-y:auto;">
<button id="beta-close" style="float:right;font-size:20px;border:none;background:none;cursor:pointer;">✖</button>
<h2>Beta</h2>
<p>Olá! Eu sou a assistente virtual da plataforma. Como posso ajudar?</p>
<input placeholder="Digite sua dúvida..." style="width:100%;padding:10px;margin-top:15px;border-radius:8px;border:1px solid #ccc;" type="text"/>
</div>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const betaButton = document.getElementById("beta-button");
  const betaDrawer = document.getElementById("beta-drawer");
  const betaClose = document.getElementById("beta-close");

  if (betaButton && betaDrawer) {
    betaButton.addEventListener("click", () => {
      betaDrawer.style.right = "0";
    });
  }

  if (betaClose && betaDrawer) {
    betaClose.addEventListener("click", () => {
      betaDrawer.style.right = "-400px";
    });
  }

  document.addEventListener("click", (e) => {
    if (
      betaDrawer &&
      !betaDrawer.contains(e.target) &&
      !betaButton.contains(e.target)
    ) {
      betaDrawer.style.right = "-400px";
    }
  });
});
</script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const html = document.documentElement;
    const body = document.body;
    const fonte = localStorage.getItem('preferenciaFonte');
    const tema = localStorage.getItem('preferenciaTema');
    const leitura = localStorage.getItem('preferenciaLeitura');

    if (tema === 'escuro') html.classList.add('dark-mode');
    else html.classList.remove('dark-mode');

    if (leitura === 'ativado') html.classList.add('modo-leitura');
    else html.classList.remove('modo-leitura');

    if (fonte) {
      html.style.setProperty('--tamanho-fonte', fonte);
    }
  });
</script>

<div class="assistente" id="assistente-virtual">
<input id="chat-input" placeholder="Digite sua pergunta..." type="text"/>
<button id="enviar-chat">Enviar</button>
</div>
</body>
</html>